# 작업 이력 정리 (메인 버튼 수정 롤백 이후 기준)

> **롤백 내용**: 메인 화면에서 "도면 그리기·도면 보관함 등 버튼이 눌리지 않는다"는 문제에 대응하기 위해 넣었던 수정은 **전부 제거**했습니다.  
> - 제거한 것: `#app-root` 래퍼, `ensureAppClickable()`, 배너 강제 `pointer-events` 처리, `data-screen` + 이벤트 위임, "클릭이 안 되면 → 새 창에서 열기" 링크, 관련 CSS  
> - 복원한 것: 메인 버튼은 다시 `onclick="goScreen('draw')"` 등 **기존 방식**으로만 동작  

아래는 **그 이전까지** 이번 대화에서 진행한 작업만 정리한 목록입니다.

---

## 1. 견적 품목·수량 관련

| 작업 | 파일 | 내용 |
|------|------|------|
| 욕조액서사리 → 욕실액서사리 | code.js, js_estimate.html | 단가표 품목명은 이미 '욕실액서사리'. 수량은 화장실 개수. 예전 이름 '욕조 액서사리' 조건 제거. |
| 청소걸·청소건 수량 = 화장실 개수 | js_estimate.html | 화장실 개수 블록에 '청소건' 추가 (청소걸은 기존 포함). |
| 힘펠환풍기 수량 = 화장실 개수 | js_estimate.html | 기존부터 화장실 개수로 처리됨. 변경 없음. |
| 티오람 미니 품목 추가 | code.js, js_estimate.html | 화장실공사 단가표에 '티오람 미니'(힘펠천풍기 아래) 추가. 수량 = 화장실 개수. 단가는 0,0(관리자에서 설정). |
| 욕조 수량 기본 1 | js_estimate.html | 화장실 개수 대신 **항상 1**로 계산하도록 변경. |

---

## 2. 견적서 저장·불러오기 (로컬)

| 작업 | 파일 | 내용 |
|------|------|------|
| 저장하기 | js_estimate.html, code.js | 현재 견적을 **이름**으로 로컬(localStorage)에 저장. `saveEstimateToLocal()` → `savedEstimatesList` 목록에 추가. |
| 불러오기 | js_estimate.html | 저장된 견적 목록 모달 표시. 선택 시 `loadSavedEstimate(id)` 로 복원 후 화면 갱신. |
| UI | js_estimate.html, index.html | 견적서 화면 헤더에 "저장하기", "불러오기" 버튼. 도면 선택 전 첫 화면에 "저장된 견적 불러오기" 버튼. |
| 삭제 | js_estimate.html | 저장 목록에서 `deleteSavedEstimate(id)` 로 항목 삭제. |

---

## 3. PDF 내보내기

| 작업 | 파일 | 내용 |
|------|------|------|
| 메인 1페이지(표지) | js_estimate.html | 공정별 여러 행 대신 **한 줄만**: 단위 "전체", 수량 "전체1", 금액 = 소계. |
| 단채움 수식 | js_estimate.html, code.js | 화장실 바닥면적 × **0.05** (기존 0.04 → 0.05). 소수점 **1자리**까지 표기. `addEstimateItem`에서 단채움은 수량 소수 유지. |
| 단채움 표기 | js_estimate.html | PDF 상세·엑셀 내보내기에서 단채움 수량 `toFixed(1)` 적용. |

---

## 4. 배포

- **clasp push** 후 **clasp deploy** 여러 번 수행.
- 버전 20개 제한으로 오래된 배포(v33, v35, v37, v40, v43, v44 등) **undeploy** 후 새 버전 배포.
- 마지막 배포 버전: **@79** (메인 버튼 클릭 대응 포함).  
  → 현재는 **메인 버튼 관련 수정 롤백** 상태이므로, 다음 배포 시 위 1~3 반영분만 포함됨.

---

## 5. 문서·구조 정리

| 파일 | 내용 |
|------|------|
| README_구글시트_앱스크립트_구조.md | 구글 시트(도면보관함, 견적_현장명, (품목) 단가표) 사용처와 code.js 함수 역할 정리. "새 창에서 열기"가 여는 URL이 웹 앱 주소임을 명시. |

---

## 요약

- **유지되는 변경**: 욕실액서사리/청소걸·청소건/티오람 미니/욕조 수량, 견적 로컬 저장·불러오기, PDF 표지(전체/전체1)·단채움(0.05, 소수 1자리).
- **롤백된 변경**: 메인 화면 버튼 클릭 대응(app-root, ensureAppClickable, 이벤트 위임, 새 창에서 열기 링크 등).  
- **미해결**: 메인에서 "도면 그리기·도면 보관함" 등 버튼이 눌리지 않는 현상은 원인 파악·다른 방식 대응이 필요함.
